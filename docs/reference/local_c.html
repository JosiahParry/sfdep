<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The Local Geary is a local adaptation of Geary's C statistic of spatial autocorrelation. The Local Geary uses squared differences to measure dissimilarity unlike the Local Moran. Low values of the Local Geary indicate positive spatial autocorrelation and large refers to negative spatial autocorrelation.
Inference for the Local Geary is based on a permutation approach which compares the observed value to the reference distribution under spatial randomness. The Local Geary creates a pseudo p-value. This is not an analytical p-value and is based on the number of permutations and as such should be used with care."><title>Compute Local Geary statistic — local_c • sfdep</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Noto%20Sans%20Display-0.4.0/font.css" rel="stylesheet"><link href="../deps/_Noto%20Sans%20Mono-0.4.0/font.css" rel="stylesheet"><link href="../deps/_Merriweather-0.4.0/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Local Geary statistic — local_c"><meta property="og:description" content="The Local Geary is a local adaptation of Geary's C statistic of spatial autocorrelation. The Local Geary uses squared differences to measure dissimilarity unlike the Local Moran. Low values of the Local Geary indicate positive spatial autocorrelation and large refers to negative spatial autocorrelation.
Inference for the Local Geary is based on a permutation approach which compares the observed value to the reference distribution under spatial randomness. The Local Geary creates a pseudo p-value. This is not an analytical p-value and is based on the number of permutations and as such should be used with care."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sfdep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/basics-of-sfdep.html">The Basics of sfdep</a>
    <a class="dropdown-item" href="../articles/conditional-permutation.html">Conditional Permutations with sfdep</a>
    <a class="dropdown-item" href="../articles/spdep-and-pysal.html">Comparison to spdep and pysal</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/josiahparry/sfdep/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute Local Geary statistic</h1>
      <small class="dont-index">Source: <a href="https://github.com/josiahparry/sfdep/blob/HEAD/R/localC.R" class="external-link"><code>R/localC.R</code></a></small>
      <div class="d-none name"><code>local_c.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The Local Geary is a local adaptation of Geary's C statistic of spatial autocorrelation. The Local Geary uses squared differences to measure dissimilarity unlike the Local Moran. Low values of the Local Geary indicate positive spatial autocorrelation and large refers to negative spatial autocorrelation.
Inference for the Local Geary is based on a permutation approach which compares the observed value to the reference distribution under spatial randomness. The Local Geary creates a pseudo p-value. This is not an analytical p-value and is based on the number of permutations and as such should be used with care.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">local_c</span><span class="op">(</span><span class="va">x</span>, <span class="va">nb</span>, <span class="va">wt</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">local_c_perm</span><span class="op">(</span><span class="va">x</span>, <span class="va">nb</span>, <span class="va">wt</span>, nsim <span class="op">=</span> <span class="fl">499</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>a numeric vector, or list of numeric vectors of equal length.</p></dd>
<dt>nb</dt>
<dd><p>a neighbor list</p></dd>
<dt>wt</dt>
<dd><p>a weights list</p></dd>
<dt>...</dt>
<dd><p>other arguments passed to <code><a href="https://r-spatial.github.io/spdep/reference/localC.html" class="external-link">spdep::localC_perm()</a></code>, e.g. <code>zero.policy = TRUE</code> to allow for zones without neighbors.</p></dd>
<dt>nsim</dt>
<dd><p>The number of simulations used to generate reference distribution.</p></dd>
<dt>alternative</dt>
<dd><p>A character defining the alternative hypothesis. Must be one of "two.sided", "less" or "greater".</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a <code>data.frame</code> with columns</p><ul><li><p><code>ci</code>: Local Geary statistic</p></li>
<li><p><code>e_ci</code>: expected value of the Local Geary based on permutations</p></li>
<li><p><code>z_ci</code>: standard deviation based on permutations</p></li>
<li><p><code>var_ci</code>: variance based on permutations</p></li>
<li><p><code>p_ci</code>: p-value based on permutation sample standard deviation and means</p></li>
<li><p><code>p_ci_sim</code>: p-value based on rank of observed statistic</p></li>
<li><p><code>p_folded_sim</code>: p-value based on the implementation of Pysal which always assumes a two-sided test taking the minimum possible p-value</p></li>
<li><p><code>skewness</code>: sample skewness</p></li>
<li><p><code>kurtosis</code>: sample kurtosis</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<div class="section">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h3>


<p>The Local Geary can be extended to a multivariate context. When <code>x</code> is a numeric vector, the univariate Local Geary will be calculated. To calculate the multivariate Local Moran provide either a list or a matrix. When <code>x</code> is a list, each element must be a numeric vector of the same length and of the same length as the neighbours in <code>listw</code>. In the case that <code>x</code> is a matrix the number of rows must be the same as the length of the neighbours in <code>listw</code>.</p>
<p>While not required in the univariate context, the standardized Local Geary is calculated. The multivariate Local Geary is <em>always</em> standardized.</p>
<p>The univariate Local Geary is calculated as \(c_i = \sum_j w_{ij}(x_i - x_j)^2\) and the multivariate Local Geary is calculated as \(c_{k,i} = \sum_{v=1}^{k} c_{v,i}\) as described in Anselin (2019).</p>
</div>

<div class="section">
<h3 id="implementation">Implementation<a class="anchor" aria-label="anchor" href="#implementation"></a></h3>


<p>These functions are based on the implementations of the local Geary statistic in the development version of spdep. They are based on <a href="https://r-spatial.github.io/spdep/reference/localC.html" class="external-link">spdep::localC</a> and <a href="https://r-spatial.github.io/spdep/reference/localC.html" class="external-link">spdep::localC_perm</a>.</p>
<p><a href="https://r-spatial.github.io/spdep/reference/localC.html" class="external-link">spdep::localC_perm</a> and thus local_c_perm utilize a conditional permutation approach to approximate a reference distribution where each observation <code>i</code> is held fixed, randomly samples neighbors, and calculated the local C statistic for that tuple (<code>ci</code>). This is repeated <code>nsim</code> times. From the simulations 3 different types of p-values are calculated—all of which have their potential flaws. So be <em>extra judicious</em> with using p-values to make conclusions.</p><ul><li><p><code>p_ci</code>: utilizes the sample mean and standard deviation. The p-value is then calculated using <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm()</a></code>--assuming a normal distribution which isn't always true.</p></li>
<li><p><code>p_ci_sim</code>: uses the rank of the observed statistic.</p></li>
<li><p><code>p_folded_sim</code>: follows the pysal implementation where p-values are in the range of [0, 0.5]. This excludes 1/2 of all p-values and should be used with caution.</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Anselin, L. (1995), Local Indicators of Spatial Association—LISA. Geographical Analysis, 27: 93-115. doi: <a href="https://doi.org/10.1111/j.1538-4632.1995.tb00338.x" class="external-link">10.1111/j.1538-4632.1995.tb00338.x</a></p>
<p>Anselin, L. (2019), A Local Indicator of Multivariate Spatial Association: Extending Geary's c. Geogr Anal, 51: 133-150. doi: <a href="https://doi.org/10.1111/gean.12164" class="external-link">10.1111/gean.12164</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Josiah Parry, <a href="mailto:josiah.parry@gmail.com">josiah.parry@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">guerry</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">transmute</a></span><span class="op">(</span>nb <span class="op">=</span> <span class="fu"><a href="st_contiguity.html">st_contiguity</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span>,</span>
<span class="r-in">                   wt <span class="op">=</span> <span class="fu"><a href="st_weights.html">st_weights</a></span><span class="op">(</span><span class="va">nb</span><span class="op">)</span>,</span>
<span class="r-in">                   geary <span class="op">=</span> <span class="fu">local_c_perm</span><span class="op">(</span></span>
<span class="r-in">                     x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">crime_pers</span>, <span class="va">literacy</span><span class="op">)</span>,</span>
<span class="r-in">                     <span class="va">nb</span>, <span class="va">wt</span></span>
<span class="r-in">                   <span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">geary</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 85 features and 12 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: MULTIPOLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 47680 ymin: 1703258 xmax: 1031401 ymax: 2677441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CRS:           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 85 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    nb      wt        ci cluster  e_ci var_ci   z_ci   p_ci p_ci_sim p_folded_sim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;nb&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">&lt;int [</span>… <span style="color: #949494;">&lt;dbl </span>… 1.09  Positi…  1.79  0.508 -<span style="color: #BB0000;">0.989</span> 0.323     0.328        0.164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">&lt;int [</span>… <span style="color: #949494;">&lt;dbl </span>… 0.557 Positi…  1.57  0.208 -<span style="color: #BB0000;">2.23</span>  0.025<span style="text-decoration: underline;">6</span>    0.024        0.012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">&lt;int [</span>… <span style="color: #949494;">&lt;dbl </span>… 0.571 Positi…  2.56  0.629 -<span style="color: #BB0000;">2.51</span>  0.012<span style="text-decoration: underline;">0</span>    0.004        0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">&lt;int [</span>… <span style="color: #949494;">&lt;dbl </span>… 0.525 Positi…  1.54  0.479 -<span style="color: #BB0000;">1.46</span>  0.143     0.076        0.038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">&lt;int [</span>… <span style="color: #949494;">&lt;dbl </span>… 1.69  Positi…  2.49  1.11  -<span style="color: #BB0000;">0.762</span> 0.446     0.472        0.236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">&lt;int [</span>… <span style="color: #949494;">&lt;dbl </span>… 0.803 Positi…  2.23  0.513 -<span style="color: #BB0000;">1.99</span>  0.046<span style="text-decoration: underline;">4</span>    0.024        0.012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">&lt;int [</span>… <span style="color: #949494;">&lt;dbl </span>… 1.99  Positi…  4.56  1.88  -<span style="color: #BB0000;">1.87</span>  0.061<span style="text-decoration: underline;">3</span>    0.056        0.028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">&lt;int [</span>… <span style="color: #949494;">&lt;dbl </span>… 1.09  Positi…  3.59  2.25  -<span style="color: #BB0000;">1.67</span>  0.095<span style="text-decoration: underline;">8</span>    0.028        0.014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">&lt;int [</span>… <span style="color: #949494;">&lt;dbl </span>… 0.547 Positi…  1.65  0.335 -<span style="color: #BB0000;">1.90</span>  0.057<span style="text-decoration: underline;">0</span>    0.024        0.012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">&lt;int [</span>… <span style="color: #949494;">&lt;dbl </span>… 0.557 Positi…  1.24  0.266 -<span style="color: #BB0000;">1.32</span>  0.186     0.18         0.09 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 75 more rows, and 3 more variables: skewness &lt;dbl&gt;, kurtosis &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   geometry &lt;MULTIPOLYGON&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Josiah Parry.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

